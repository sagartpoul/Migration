DECLARE
v_ExistCount NUMBER := 0;
BEGIN

DBMS_OUTPUT.PUT_LINE ('....START...constructing BE_CODES_MAP.....');

--DROP TABLE IF EXISTS
	SELECT COUNT(*) INTO v_ExistCount FROM user_tables
	WHERE TABLE_NAME = 'BE_CODES_MAP';
	
	IF (v_ExistCount = 1 ) THEN
		EXECUTE IMMEDIATE 'DROP TABLE BE_CODES_MAP';
	END IF;
--STEP-1--START-CREATE TABLE BE_CODES_MAP
	EXECUTE IMMEDIATE
	'CREATE TABLE  "BE_CODES_MAP" 
	   (
		"CL_GR_CODE" VARCHAR2(50),
		CL_PARENT_CODE VARCHAR2(10),
		"CL_CODE" VARCHAR2(50),		
		"CL_TITLE" VARCHAR2(50),
		"BE_GR_CODE" VARCHAR2(50),
		"BE_CODE" VARCHAR2(50),
		"BE_TITLE" VARCHAR2(50),
		"REMARK" VARCHAR2(50)
		)';
	DBMS_OUTPUT.PUT_LINE ('....created table BE_CODES_MAP.....');
	EXECUTE IMMEDIATE 'CREATE INDEX "BE_CODES_MAP_BE_IDX1" ON  "BE_CODES_MAP" ("BE_GR_CODE", "CL_CODE")';
--STEP-1--START-CREATE TABLE BE_CODES_MAP
END;
/